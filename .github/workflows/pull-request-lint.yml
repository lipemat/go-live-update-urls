##############################
# Test and lint files in a pull request.
#
# @version 0.0.3
#
##############################

name: Test & Lint Files

on:
  pull_request:
    types:
      - opened
      - edited
      - synchronize

jobs:
  php-lint:
    strategy:
      matrix:
        php: [ 7.4, 8.0, 8.1, 8.2, 8.3 ]
    uses: lipemat/public-actions/.github/workflows/php-lint.yml@master
    with:
      php: ${{ matrix.php }}
  
  wp-unit:
    strategy:
      matrix:
        wp: [ 6.2.6, 6.6.1 ]
        php: [ 7.4, 8.3 ]
        multisite: [ 'single', 'multisite' ]
    uses: lipemat/public-actions/.github/workflows/wp-unit-plugin.yml@master
    with:
      basic: go-live-update-urls
      pro: go-live-update-urls-pro
      multisite: ${{ matrix.multisite }}
      php: ${{ matrix.php }}
      wp: ${{ matrix.wp }}
    secrets: inherit
    
  phpstan:
    strategy:
      matrix:
        combination:
          - php: 7.4
            stubs: 6.2.5
          - php: 8.3
            stubs: 6.6.0
    uses: lipemat/public-actions/.github/workflows/phpstan-plugin.yml@master
    with:
      basic: go-live-update-urls
      dir: content/plugins/go-live-update-urls
      pro: go-live-update-urls-pro
      php: ${{ matrix.combination.php }}
      stubs: ${{ matrix.combination.stubs }}
    secrets: inherit
